# Chap1 数值计算导论

## 1.1 概述

### 1.1.1  数值计算与数值算法

### 1.1.2数值计算的问题与策略

#### 应用数值计算的情况：

- 没有解析解的数学问题；
- 解析公式计算复杂的问题；
- 再科学和工程研究中模拟模拟难以形成的实验条件

#### 结局问题的步骤：

- 根据相关北京建立数学模型；
- 研究数值求解这个方程的算法；                   <star>
- 通过计算机程序或软件实现这个算法；        <star>   
- 在计算机上运行进行数值模拟；
- 将计算结果用较为直观的方式输出；
- 解释并确认计算结果；

通常使用的近似方法有：

- 无限维空间 => 有限维空间
- 无限过程 => 优先过程
- 微分方程 => 代数方程
- 非线性问题 => 线性问题
- 高阶系统 => 低阶系统
- 复杂函数 => 简单函数
- 一般矩阵 => 简单结构矩阵

### 1.1.3 数值计算软件

## 1.2 误差分析基础

### 1.2.1 数值计算的近似

#### 存在误差的情况：

- 建立数学模型时候的近似；
- 经验或测量造成的数据误差；(重要的物理常数等等都是由实验得到的，会存在误差)
- 输入数据来自以前计算的结果；

### 1.2 2 误差及其分类

> 定义 1.1 绝对误差

$$
设准确值x对应的近似值为\hat{x}，则误差e(\hat{x})=\hat{x}-x，也被称为绝对误差。
$$

> 定义1.2 相对误差

$$
设准取值x对应的近似值为\hat{x}，则其相对误差为
\\
e(\hat{x})=\frac{\hat{x}-x}{x}=\frac{e(\hat{x})}{x}
$$

关于定义1.2需要注意：

- 绝对误差不是绝对值，可正可负；
- 如果真实值为0，绝对误差没有意义；
- 相对误差大于100%认为计算完全错误；（结果以百分号形式记录）

> 定义1.3 有效数字
> $$
> 一个数的有效数字指从左至右第一位非零数字开始的所有数字
> $$



> 定理1.1
> $$
> 设\hat{x}为x的近似值，若\hat{x}前p位有效数字正确(p\geq1)，则其相对误差满足
> \\
> |e_r(\hat{x})| < \frac{1}{d_0}\times10^{-p+1}
> $$
> 证明：将准确值表示出来然后相减得到恒等式。这里面认为的正确应该是相等；
> $$
> 设\hat{x}=\pm10^{m}\times(d_0+\frac{1}{10}d_{1}+\frac{1}{10^2}d_2+...+\frac{1}{10^{p-1}}d_{p-1})
> \\
> 于是就有 |\hat{x}-x| < 10^m \times 10^{1-p}
> \\
> 又因为 |x| \geq 10^m\times d_0，上下除得到结果。
> $$

#### 上面发现范围并不是很紧，所以可以得到推论

> 定理1.2
> $$
> 设\hat{x}为x的近似值，若\hat{x}前p位有效数字正确(p\geq1)，则其相对误差满足
> \\
> |e_r(\hat{x})| \leq \frac{1}{2d_0}\times10^{-p+1}
> $$

> 定理1.3
> $$
> 设x的第一位有效数字位d，若近似值\hat{x}的相对误差满足
> \\
> |e_r{\hat{x}}| \leq \frac{1}{2(d_0+1)}\times 10^{-p+1}
> \\
> 则\hat{x}前p位有效数字正确，或者保留p位有效数字后\hat{x}和x的结果相等。
> $$
> 证明：
> $$
> 设x=\pm10^{m}\times(d_0+\frac{1}{10}d_{1}+\frac{1}{10^2}d_2+...+\frac{1}{10^{p-1}}d_{p-1}+...)
> \\
> |x| < 10^m \times (d_0+1)
> 于是由已知就有|e(\hat{x})|=|e_r(\hat{x})\cdot x| < 10^m \times \frac{1}{2} \times 10^{-p+1}
> \\
> 于是就有有效数字一定相同。
> $$

#### 因为这里面d一定小于10，所以就有一下推论；

> 定理1.4
> $$
> 若x的近似值\hat{x}的相对误差满足
> \\
> |e_r(\hat{x})| \leq \frac{1}{2} \times 10^{-p}
> \\
> 则\hat{x}至少前p位有效数字正确，或者在保留p位有效数字之后\hat{x}和x相等。
> $$

> 定义1.4 数据传递误差
> $$
> 一个数值计算过程的数据传递误差，指单纯由问题输入数据误差引起的计算结果的误差。(假设问题被精确求解)
> $$

> 定义1.5 计算误差
> $$
> 计算误差指计算过程中的近似引起的计算结果误差。
> $$

> 定义1.6 截断误差
> $$
> 截断误差是指实际输入对应的准确结果和用给定算法精确计算得到的结果之间的差，反映了数值方法对原始数学问题的
> \\简化和近似。
> $$

> 定义1.7 舍入误差
> $$
> 舍入误差是指给定算法经精确计算得到的结果与同样的算法经有限精度运算得到结果之间的差。
> $$

### 1.2 3 问题的敏感性与数据传递误差的估算

> 定义1.8 问题的敏感性 => 不考虑具体算法
> $$
> 问题的敏感性是指输入数据的扰动对问题的影响程度的大小；也成为问题的病态性。
> \\
> 不敏感===良态的 | 敏感===病态的
> $$

> 定义1.9 问题的(相对条件数)
> $$
> cond = \frac{||问题的解的相对变化量||}{||输入数据的相对变化量||}
> \\
> 其中算符||\cdot||表示范数，度量一个量的大小。
> \\
> 对于复数量来讲，范数就是其绝对值。
> $$
> 如果问题的条件数远远大于1，称这个问题是病态的；若问题是病态的，则输入数据的相对误差很小，引起解的相对误差越大。用函数求值举例：
> $$
> cond=\frac{||\frac{f(\hat{x})-f(x)}{f(x)}||}{||\frac{\hat{x}-x}{x}||}
> $$
> 这里面的函数的相对误差可以用导数进行近似
> $$
> \frac{f(\hat{x})-f(x)}{f(x)} \approx \frac{f(x)' \cdot e(\hat{x})}{f(x)}
> cond = \frac{x\cdot f(x)}{f(x)}
> $$

##### 这里面我们可以通过微分来来计算传递误差限：

$$
\epsilon(\hat{y}) = \sum_{i=1}^{n}|\frac{\partial f}{\partial x_i}(\hat{x}_1,...,\hat{x}_n)|\epsilon(\hat{x}_i)
$$

### 1.2.4 算法稳定性 

稳定性反映了扰动对于计算结果的影响，也称为数值稳定性。(需要考虑舍入误差)

举例：
$$
一直按两位有效数字计算结果
\\
1 + 0.01 + ... + 0.01 (999个) = 1
\\
但是如果按照递增排序得到：
\\
0.01 + ... + 0.0.1 + 1 = 11
$$

> 定义1.10 向后误差
>
> 向后误差是指加设计算过程中没有近似时，将结果误差折算为初始数据上的扰动，即向后误差是等效的初始数据误差。
>
> 向后误差反映了算法的稳定性，如果向后误差小，那么说明计算中的扰动仅仅等效为较小的输入数据扰动，算法应该是稳定的

## 1.3 计算机浮点数系统与舍入误差

### 1.3.1 计算机浮点数系统

> ### 课堂笔记：
>
> 定义浮点数：
> $$
> x = \pm (d_0 + \frac{d_1}{2} + \frac{d_2}{2^2}+...+\frac{d_{p-1}}{2^{p-1}})
> $$
>
> * p称为尾数/精度，E称为指数
> * 规范化技术中d0 = 1
>
> 浮点数系统在计算机上的分布，可以用平移进行模拟。例如课件上1-2 平移到 2-4 平移到4-8\
> $$
> 机器精度\epsilon_{mach} = 2^{-p} (1与右边相邻数间隔一半)
> $$
>
> 定理1.5：浮点数的相对误差小于机器精度
>
> 定理1.6：如果两个数的比值小于机器误差一半，则做和只与上面有关。
>
> 出现抵消现象，两个数相减出现有效数字减少的情况。但是可以改变公式进行修正，例如求根公式。
>
> 需要遵循的内容：
>
> - 避免中间过程出现上下溢出
> - 避免大数吃小数（调整顺序）
> - 避免符号相同的两相近数相减（抵消现象）
> - 简化运算步骤，减少运算次数
>
> 



