# Chap4 线性方程组的迭代解法

## 迭代法的基本概念

### 求解线性方程组$Ax = b$的迭代解法

通过向量序列逼近准确解

类似于不动点迭代法的构造：$x^{(k+1)} = \varphi(x^{(k)})$

$x = \varphi(x)$为与原方程等价的方程

希望每个迭代步骤计算量尽可能小，$\varphi$为线性函数：
$$
x^{(k+1)} = bx^{(k)} + f
$$
b,f为常数矩阵和向量，称为一介定常迭代法

### Jacobi迭代法

$$
\left(
\begin{matrix}
a_{11} & a_{12} & a_{13} \\
a_{21} & a_{22} & a_{23} \\
a_{31} & a_{32} & a_{33} \\
\end{matrix}
\right)
\left(
\begin{matrix}
x_{1} \\
x_{2} \\
x_{3} \\
\end{matrix}
\right)
=
\left(
\begin{matrix}
b_{1} \\
b_{2} \\
b_{3} \\
\end{matrix}
\right)
$$

推导成：
$$
x_1 = -\frac{1}{a_{11}}(a_{12}x_2+a_{13}x_3) + \frac{b1}{a_{11}} \\
x_2 = -\frac{1}{a_{22}}(a_{21}x_1+a_{23}x_3) + \frac{b2}{a_{22}} \\
x_3 = -\frac{1}{a_{33}}(a_{31}x_1+a_{32}x_2) + \frac{b1}{a_{33}}
$$
就可以通过这个进行迭代运算；
$$
A = D-(D-A)	\ \ \ 	D为对角阵
$$

### 迭代法的有关理论

判停准则：

- 类似非线性方程求根：残差判据，误差判据；
- $||b-Ax^{(k)}||\le\epsilon_1$，并不意味着误差小，并且计算量大；
- $||x^{(k)}-x^{(k-1)}||\epsilon_2$，有缺陷但是常用

一阶定常迭代法的收敛性

$x^{k+1} = Bx^{(k)} + f$考虑误差$e^{(k+1)} = x^{(k+1)}-x^*$，$x^* = Bx^*+f \ \to \ e^{(k+1)} = Be^{(k)}$ 

定义4.1：矩阵的收敛，如果每一个项收敛到一个值，则矩阵收敛到这些值组成的矩阵

### 三种迭代法的收敛条件

> 定理4.8 Jacobi迭代法的收敛性判断

> 定理4.11：对角占优矩阵：对严格对角占优矩阵，若松弛因子$0< \omega \le 1$，求解$Ax = b$的SOR迭代法收敛；（证明hint：迭代矩阵，特征方程，反证法）

> 定理4.12：对称正定矩阵A（不要求证明）
>
> - 求解$Ax = b$的G-S迭代法收敛；
> - 若$0 < \omega < 2$，则响应的SOR迭代法收敛；

> 定理4.13：SOR迭代法收敛的必要条件
>
> 松弛因此$\omega$满足：$0<\omega < 2$
>
> 证明：略



## 共轭梯度法

### 最快下降法

构造迭代法的新思路：

- 一阶定长迭代法（SOR），对大规模矩阵收敛慢；
- 变分原理：解线性方程组 $\to$ 在n为线性空间搜索；
- 设A对称正定，求n原二次函数$\varphi(x) = \frac{1}{2}x^TAx - b^Tx$的最小值点；

$$
\frac{\partial \varphi}{\partial x_1} = a_{11} + \sum_{j\ne 1} a_{1j}x_j -b_1 = 0 \ \to \ Ax-b = 0		\\
\frac{\partial \varphi}{\partial x_n} = a_{11} + \sum_{j\ne 1} a_{nj}x_j -b_n = 0
$$

$\varphi(x)$是定义在Rn空间上的标量场；

$\varphi(x)$最小值对应的x就是$Ax = b$的解；（如果A负定，那么就是最大值）

#### 直接搜索

求最小值点，无约束优化问题，逐次搜索：$x^{(0)},...,x^{(k)},...$；

在当前点$x^{(k)}$，设搜索方向为$p^{(k)}$，其中$x^{(k+1)} = x^{(k)} + \alpha_kp^{(k)}$；

步长$\alpha_k$应该使$\varphi(x^{(k+1)})$最小； $\alpha_k = \frac{(r^{(k)})^Tp^{(k)}}{(p^{(k)})Ap^{(k)}}$；记$r^{(k)} = b-Ax^{(k)}$；

有一个性质就是$(p^{(k)})^Tr^{(k+1)} = 0$；

### 共轭梯度法

改进之处：没有必要沿最速下降方向搜索；

- 当前点$x^{(k)}$，$\varphi(x)$的减小最快方向是$r^{(k)}$
- 前一个搜索方向是$p^{(k-1)}$，则$x^{(k+1)}=x^{(k)}+\xi r^{(k)} + \eta p^{(k-1)}$；
- 在过$x^{(k)}$，上述两方向张成的平面上找函数$\varphi(x)$的最小值；

几个重要的结论

- $(p^{(k)})^TAp^{(k-1)} = 0$，搜索方向A正交；
- $x^{(k+1)}\in x^{(0)}+span\{r^{(0k)},Ar^{(0)},...,A^kr^{(0)}\}$

说明几点

- 针对对称正定矩阵，是具有迭代法形式的直接解法；
- 虽然n步收敛到准确解，但是k很大的时候，舍入误差严重；
- 对于病态矩阵，可能收敛很慢，甚至不收敛；

预条件技术

- 改善系数矩阵病态性，加速迭代法的收敛；
- CG法；

### 方法比较

#### 迭代法的比较

- 二维模型问题，不同大小的一系列稀疏矩阵；
- 收敛速度：Jocbi < G-S < SOR < CG；
- 随着k增大，前三种方法的$\rho(B)$趋近于1；
- 共轭梯度法的收敛速度男分析，但常表现超线性收敛；

#### 直接发与迭代法比较

- 直接法稳定、通用，但不够灵活，出力大规模问题有困难；
- 迭代法很好利用矩阵稀疏性，较灵活，耽误通用的有效方法；需要依靠预条件；

#### 迭代法与直接解法比较

|           Complexity           |       Sparse        |        Dense         |
| :----------------------------: | :-----------------: | :------------------: |
|        Krylov iterative        | $O(KN) \le O(N^2)$  | $O(KN^2) \le O(N^3)$ |
| Direct Method LU decomposition | $O(N^{1.2\to1.8})$$ |      $O(N^3)$$       |

